<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <title>Hello, world!</title>
  </head>
  <body>
    <div class="container">
      <%- include('header'); %>
     <nav>
          <a href="/">Home</a>
          <a href="/"></a>
     </nav>
     <main>
       <h2>Main</h2>
       <img src="img/icon.png" alt="">
       <% if (user) { %>
        <p><%= user.name %></h2>
        <p><%= user.id %></h2>
    <% } %>  

    <h2>Data from Array</h2>
        <ol>
            <% month.forEach((i)=>{ %>
                <li><%= i %></li>
            <% }); %>
        </ol>
    
    
      <div class="mb-3">
       <fieldset>
         <legend>Post Data</legend>
         <form action="/postdata" method="post">
          <label>Username: <input class="form-control" type="text" name="username" required></label>
          <label>Password: <input class="form-control" type="password" name="userpass" maxlength="6" required></label>
          <button class="btn btn-success" type="submit">Send</button>
        </form>
       </fieldset>
      </div>

      <div class="mb-5"> 
        <fieldset>
          <legend>Get Data</legend>
        <form action="/search" role="search">
        <label>Search <input class="form-control" type="search" name="product" required> </label>
        <button class="btn btn-primary">Search</button>
      </form></fieldset>
      <table class="table table-bordered">
        <tr><th>Name</th><th>Body Type</th><th>Price</th></tr>
      </table>
    </div>

     </main>
     <%- include('footer'); %>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
   
    <script>

    fetch('http://127.0.0.1/api').then(i=>i.json()).then(i=>console.log(i));

    document.querySelector('input[type="search"]').addEventListener("input",function(){
      let data=this.value;

      if( data.length>2){
        fetch('http://127.0.0.1/searchdata',{method:"POST",body:JSON.stringify({"product":data})}).then(i=>i.json()).then(i=>{
            document.querySelector("table").innerHTML+=`<tr><td>${i.name}</td><td>${i.type}</td><td>${i.price}</td></tr>`;
        });
      }

    });

    </script>

    <script>

    </script>
  </body>
</html>